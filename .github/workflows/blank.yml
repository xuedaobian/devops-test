name: CI

on: [push] # push时触发

jobs:
  build:
    runs-on: ubuntu-latest # 执行环境为ubuntu-latest
    steps:
    - uses: actions/checkout@v2 # 现成actions，获取源码
    - uses: actions/setup-node@v1 # 安装nodejs，版本指定10
      with:
        node-version: '10.x'
    - name: Deploy static to Tencent CloudBase
      id: deployStatic
      uses: TencentCloudBase/cloudbase-action@v1.1.0
      with:
        secretId: ${{ secrets.TENCENT_CLOUDBASE_SECRET_ID }} # 值存放在第二步所说的secrets中
        secretKey: ${{ secrets.TENCENT_CLOUDBASE_SECRET_KEY }} # 同上
        envId: dev-test-0fyhq
    - name: cf deploy # cf deploy
      env: 
        ENV_ID: dev-test-0fyhq
      run: cloudbase functions:deploy gahello --force --all -e ENV_ID
